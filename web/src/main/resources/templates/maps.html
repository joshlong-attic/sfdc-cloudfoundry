<!DOCTYPE HTML>
<html ng-app="sfdc" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Google Force
    </title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <meta charset="utf-8"/>
    <link href="webjars/bootstrap/3.0.2/css/bootstrap.css" rel="stylesheet"/>
    <style>
        #bar {
            position: absolute;
        }

        html, body, #map-canvas {
            height: 100%;
            margin: 0px;
            padding: 0px;
            z-index: -10;
        }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;sensor=false"></script>


    <script src="webjars/jquery/2.0.3/jquery.js"></script>
    <script src="webjars/bootstrap/3.0.2/js/bootstrap.js"></script>
    <script src="webjars/stomp-websocket/2.3.0/stomp.js"></script>
    <script src="webjars/sockjs-client/0.3.4/sockjs.js"></script>
    <script src="webjars/angularjs/1.2.11/angular.js"></script>
    <script src="webjars/angularjs/1.2.11/angular-resource.js"></script>


    <script language="JavaScript">
        <!--
        // setup the map
        function installMap(point, points) {

            var pos = new google.maps.LatLng(point.latitude, point.longitude);

            var map = new google.maps.Map(
                    document.getElementById('map-canvas'), {

                        center: pos,
                        zoom: 13,
                        mapTypeId: google.maps.MapTypeId.ROADMAP,

                        panControl: true,
                        mapTypeControl: false,
                        panControlOptions: {
                            position: google.maps.ControlPosition.RIGHT_CENTER
                        },
                        zoomControl: true,
                        zoomControlOptions: {
                            style: google.maps.ZoomControlStyle.LARGE,
                            position: google.maps.ControlPosition.RIGHT_CENTER
                        },
                        scaleControl: false,
                        streetViewControl: false,
                        streetViewControlOptions: {
                            position: google.maps.ControlPosition.RIGHT_CENTER
                        }
                    });

            new google.maps.InfoWindow({
                map: map,
                position: pos,
                content: 'You Are Here'
            });

            if (points && points.length > 0) {
                for (var i = 0; i < points.length; i++) {
                    new google.maps.InfoWindow({
                        map: map,
                        position: new google.maps.LatLng(points[i].latitude, points[i].longitude),
                        content: points [i].name
                    });
                }
            }
        }


        $(function () {
            // show the map with the current browser at the center
            navigator.geolocation.getCurrentPosition(function (position) {

                var points = [];
                points.push({latitude: 37.7820492, longitude: -122.4040513, name: '875 Howard St'});
                points.push({latitude: 37.7929789, longitude: -122.4212424, name: '94109'});
                points.push({latitude: 37.7749295, longitude: -122.4194155, name: 'San Francisco, CA'})

                installMap({latitude: position.coords.latitude, longitude: position.coords.longitude}, points);
            });
        });


        var appName = 'sfdc';
        var module = angular.module(appName, [ 'ngResource'  ]);

        function SfdcController($scope, $http) {

            $scope.query = 'josh';

            $http.get('/user').success(function (data) {
                $scope.user = data;
            });
            $scope.process = function () {
                $http.post('/process', $scope.query).success(function (data) {
                    $scope.batchData = data;
                });
            };
        }

        //-->
    </script>


</head>
<body>

<div ng-controller="SfdcController">

    <div id="status">

        <div>Welcome <b>{{user.username}}</b>!</div>

        <div>
            <form name="searchForm">
                <input type="text" class="search" name="query" ng-model="query"/>
                <a ng-click="process()" href="">Search</a>
            </form>
        </div>
        <br/>
        <table>
            <tr>
                <td style="color: lightgrey">Batch ID</td>
                <td>{{batchData.batchId}}</td>
            </tr>
            <tr>
                <td style="color: lightgrey">Access Token</td>
                <td> {{batchData.accessToken}}</td>
            </tr>
            <tr>
                <td style="color: lightgrey">API Endpoint</td>
                <td> {{batchData.apiEndpoint}}</td>
            </tr>
        </table>

    </div>


</div>
<div class="bar">

    Google Force

</div>
<div id="map-canvas"></div>

</body>
</html>